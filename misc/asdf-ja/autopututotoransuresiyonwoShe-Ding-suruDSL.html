<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- このマニュアルはASDF――Common Lispプログラムとライブラリのためのシス
テム定義ツール――について解説したものです。

このマニュアルの最新バージョン（訳注: 英語版）は以下にあります:
https://common-lisp.net/project/asdf/asdf.html 
[訳者補足]

この非公式の日本語訳は、ASDFの公式リポジトリのフォークとしてGitLab上で編集されています。（https://gitlab.common-lisp.net/hishimaru/asdf/tree/ja） 翻訳に関する訂正、意見などは常に歓迎します。その際はIssuesを使っていただけると確実です。

[訳者補足終わり]


ASDF Copyright (C) 2001-2018 Daniel Barlow and contributors.

This manual Copyright (C) 2001-2018 Daniel Barlow and contributors.

This manual revised (C) 2009-2018 Robert P. Goldman and Francois-Rene Rideau.

This manual translated into Japanese (C) 2018 Hugo Ishimaru.

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 -->
<!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>アウトプットトランスレーションを設定するDSL (ASDF マニュアル)</title>

<meta name="description" content="アウトプットトランスレーションを設定するDSL (ASDF マニュアル)">
<meta name="keywords" content="アウトプットトランスレーションを設定するDSL (ASDF マニュアル)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Suo-Yin-_0028Yong-Yu-_0029.html#g_t_7d22_5f15_ff08_7528_8a9e_ff09" rel="index" title="索引（用語）">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="ASDFgakonpairusaretahuairuwoBao-Chi-suruChang-Suo-woShe-Ding-suru.html#ASDF_304c_30b3_30f3_30d1_30a4_30eb_3055_308c_305f_30d5_30a1_30a4_30eb_3092_4fdd_6301_3059_308b_5834_6240_3092_8a2d_5b9a_3059_308b" rel="up" title="ASDFがコンパイルされたファイルを保持する場所を設定する">
<link href="Output-Configuration-Directories.html#Output-Configuration-Directories" rel="next" title="Output Configuration Directories">
<link href="Hou-Fang-Hu-Huan-Xing-notamenoJi-Neng-_0028autopututotoransuresiyon_0029.html#g_t_5f8c_65b9_4e92_63db_6027_306e_305f_3081_306e_6a5f_80fd_ff08_30a2_30a6_30c8_30d7_30c3_30c8_30c8_30e9_30f3_30b9_30ec_30fc_30b7_30e7_30f3_ff09" rel="prev" title="後方互換性のための機能（アウトプットトランスレーション）">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="../manual-ja.css">


</head>

<body lang="ja">
<a name="g_t_30a2_30a6_30c8_30d7_30c3_30c8_30c8_30e9_30f3_30b9_30ec_30fc_30b7_30e7_30f3_3092_8a2d_5b9a_3059_308bDSL"></a>
<div class="header">
<p>
Next: <a href="Output-Configuration-Directories.html#Output-Configuration-Directories" accesskey="n" rel="next">Output Configuration Directories</a>, Previous: <a href="Hou-Fang-Hu-Huan-Xing-notamenoJi-Neng-_0028autopututotoransuresiyon_0029.html#g_t_5f8c_65b9_4e92_63db_6027_306e_305f_3081_306e_6a5f_80fd_ff08_30a2_30a6_30c8_30d7_30c3_30c8_30c8_30e9_30f3_30b9_30ec_30fc_30b7_30e7_30f3_ff09" accesskey="p" rel="prev">後方互換性のための機能（アウトプットトランスレーション）</a>, Up: <a href="ASDFgakonpairusaretahuairuwoBao-Chi-suruChang-Suo-woShe-Ding-suru.html#ASDF_304c_30b3_30f3_30d1_30a4_30eb_3055_308c_305f_30d5_30a1_30a4_30eb_3092_4fdd_6301_3059_308b_5834_6240_3092_8a2d_5b9a_3059_308b" accesskey="u" rel="up">ASDFがコンパイルされたファイルを保持する場所を設定する</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Suo-Yin-_0028Yong-Yu-_0029.html#g_t_7d22_5f15_ff08_7528_8a9e_ff09" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="autopututotoransuresiyonwoShe-Ding-suruDSL"></a>
<h3 class="section">9.3 アウトプットトランスレーションを設定するDSL</h3>

<p>アウトプットトランスレーションの設定は、S式によるDSLで行います。以下はその文法です:
</p>
<div class="example">
<pre class="example">;; 設定の１単位は１つのS式であり、S式はキーワード:source-registryから
;; 始まって１つ以上のディレクティブが続きます。
CONFIGURATION := (:output-translations DIRECTIVE ...)

;; ディレクティブは次のいずれかです:
DIRECTIVE :=
    ;; 継承ディレクティブ:
    ;; CONFIGURATIONは<em>必ず</em>次の２つのディレクティブのいずれかを含ま
    ;; なければなりません。
    :inherit-configuration |
    ;; 継承した設定をその位置に挿入するディレクティブで、多くの場合、
    ;; 最後に指定されます。<a name="DOCF49" href="#FOOT49">(49)</a>
    :ignore-inherited-configuration |
    ;; 継承した設定を除外します。どこに指定してもかまいません。

    ;; 前方互換性のためのディレクティブ（ASDF 2.011.4）以降です。新し
    ;; い設定機能を使いたいが、その機能をサポートしていない古いASDFか
    ;; ら新しいASDFをブートストラップして使っているという場合には、こ
    ;; のディレクティブが必要でしょう。
    :ignore-invalid-entries |

    ;; 別の設定ファイルまたは設定ディレクトリをインクルードします。
    (:include PATHNAME-DESIGNATOR) |

    ;; ユーザーキャッシュを有効にします。環境に応じて、例えば
    ;; ~/.common-lisp/cache/sbcl-1.0.45-linux-amd64/や
    ;; C:/Users/foo/AppData/Local/cache/common-lisp/sbcl-1.4.2-win-x64/
    ;; などが使われるでしょう。デフォルトでは有効です。
    :enable-user-cache |
    ;; ユーザーキャッシュを無効にします。/が/にマップされることになり
    ;; ます。
    :disable-cache |

    ;; １つのマッピングを(入力　出力)として追加します。
    (DIRECTORY-DESIGNATOR DIRECTORY-DESIGNATOR)

    ;; 入力パスのトランスレーションを関数で行うように指定します。
    (DIRECTORY-DESIGNATOR (:function TRANSLATION-FUNCTION))

DIRECTORY-DESIGNATOR :=
    NIL | ; 入力に指定した場合: このエントリをスキップします。
          ; 出力に指定した場合: 入力されたパス名を同じパス名にマップします。
    T | ; 入力に指定した場合: あらゆる入力パスに対応します。
        ; 出力に指定した場合: 入力されたパス名を同じパス名にマップします。
    ABSOLUTE-COMPONENT-DESIGNATOR ; → <a href="sosurezisutoriwoShe-Ding-suruDSL.html#g_t_30bd_30fc_30b9_30ec_30b8_30b9_30c8_30ea_3092_8a2d_5b9a_3059_308bDSL">ソースレジストリを設定するDSL</a>

TRANSLATION-FUNCTION :=
    ;; 入力パスを出力パスに変換する関数です。この関数は２つの引数を取
    ;; り、１つ目は変換するべきパス名であり、２つ目は入力に指定した
    ;; DIRECTORY-DESIGNATORです。
    SYMBOL |
    LAMBDA

</pre></div>



<p>&lsquo;ABSOLUTE-COMPONENT-DESIGNATOR&lsquo;の末尾のコンポーネントがパス名でない場合、<samp>/**/*.*</samp>が加わっているものとみなされます。末尾のコンポーネントにパス名を使うと、<code>#p&quot;some/path/**/foo*/bar-*.fasl&quot;</code>のようにより細かいパターンを指定することができます。（→ <a href="sosurezisutoriwoShe-Ding-suruDSL.html#g_t_30bd_30fc_30b9_30ec_30b8_30b9_30c8_30ea_3092_8a2d_5b9a_3059_308bDSL">ソースレジストリを設定するDSL</a>）
</p>
<p><code>#+フィーチャー</code>のようなフィーチャー表現も設定ファイル中で使うことが出来ます。
</p>
<p>The second designator of a mapping may be <code>nil</code>, indicating that files are not mapped
to anything but themselves (same as if the second designator was the same as the first).
</p>
<p>When the first designator is <code>t</code>,
the mapping always matches.
When the first designator starts with <code>:root</code>,
the mapping matches any host and device.
In either of these cases, if the second designator
isn&rsquo;t <code>t</code> and doesn&rsquo;t start with <code>:root</code>,
then strings indicating the host and pathname are somehow copied
in the beginning of the directory component of the source pathname
before it is translated.
</p>
<p>When the second designator is <code>t</code>, the mapping is the identity.
When the second designator starts with <code>:root</code>,
the mapping preserves the host and device of the original pathname.
Notably, this allows you to map files
to a subdirectory of the whichever directory the file is in.
Though the syntax is not quite as easy to use as we&rsquo;d like,
you can have an (source destination) mapping entry such as follows
in your configuration file,
or you may use <code>enable-asdf-binary-locations-compatibility</code>
with <code>:centralize-lisp-binaries nil</code>
which will do the same thing internally for you:
</p><div class="lisp">
<pre class="lisp">#.(let ((wild-subdir
          (make-pathname :directory '(:relative :wild-inferiors)))
        (wild-file
          (make-pathname :name :wild :version :wild :type :wild)))
   `((:root ,wild-subdir ,wild-file)
     (:root ,wild-subdir :implementation ,wild-file)))
</pre></div>
<p>Starting with ASDF 2.011.4, you can use the simpler:
	<code>`(:root (:root :**/ :implementation :*.*.*))</code>
</p>


<p><code>:include</code> statements cause the search to recurse with the path specifications
from the file specified.
</p>
<p>If the <code>translate-pathname</code> mechanism cannot achieve a desired
translation, the user may provide a function which provides the
required algorithm.  Such a translation function is specified by
supplying a list as the second <code>directory-designator</code>
the first element of which is the keyword <code>:function</code>,
and the second element of which is
either a symbol which designates a function or a lambda expression.
The function designated by the second argument must take two arguments,
the first being the pathname of the source file,
the second being the wildcard that was matched.
When invoked, the function should return the translated pathname.
</p>
<p>An <code>:inherit-configuration</code> statement causes the search to recurse with the path
specifications from the next configuration in the bulleted list.
See <a href="ASDFgakonpairusaretahuairuwoBao-Chi-suruChang-Suo-woShe-Ding-suru.html#ASDF_304c_30b3_30f3_30d1_30a4_30eb_3055_308c_305f_30d5_30a1_30a4_30eb_3092_4fdd_6301_3059_308b_5834_6240_3092_8a2d_5b9a_3059_308b">Configurations</a>, above.
</p>
<a name="index-asdf_003a_003a_002auser_002dcache_002a"></a>
<ul>
<li> <code>:enable-user-cache</code> is the same as <code>(t :user-cache)</code>.
</li><li> <code>:disable-cache</code> is the same as <code>(t t)</code>.
</li><li> <code>:user-cache</code> uses the contents of variable <code>asdf::*user-cache*</code>
which by default is the same as using
<code>(:home &quot;.cache&quot; &quot;common-lisp&quot; :implementation)</code>.
</li></ul>


<div class="footnote">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h3><a name="FOOT49" href="#DOCF49">(49)</a></h3>
<p>[訳注] 継承した設定(inherited configuration)とは、<a href="autopututotoransuresiyonnoShe-Ding-.html#g_t_30a2_30a6_30c8_30d7_30c3_30c8_30c8_30e9_30f3_30b9_30ec_30fc_30b7_30e7_30f3_306e_8a2d_5b9a">アウトプットトランスレーションの一連の設定</a>において、<strong>後</strong>で処理される設定を指します。つまり、大ざっぱに言えば、箇条書きの下の処理に相当します。「継承」の語感から逆に考える方もいるかもしれないので、注意しておきます。<code>:ignore-inherited-configuration</code>の指定があると、ソースレジストリの設定がそこで終わることになります。</p>
</div>
<hr>
<div class="header">
<p>
Next: <a href="Output-Configuration-Directories.html#Output-Configuration-Directories" accesskey="n" rel="next">Output Configuration Directories</a>, Previous: <a href="Hou-Fang-Hu-Huan-Xing-notamenoJi-Neng-_0028autopututotoransuresiyon_0029.html#g_t_5f8c_65b9_4e92_63db_6027_306e_305f_3081_306e_6a5f_80fd_ff08_30a2_30a6_30c8_30d7_30c3_30c8_30c8_30e9_30f3_30b9_30ec_30fc_30b7_30e7_30f3_ff09" accesskey="p" rel="prev">後方互換性のための機能（アウトプットトランスレーション）</a>, Up: <a href="ASDFgakonpairusaretahuairuwoBao-Chi-suruChang-Suo-woShe-Ding-suru.html#ASDF_304c_30b3_30f3_30d1_30a4_30eb_3055_308c_305f_30d5_30a1_30a4_30eb_3092_4fdd_6301_3059_308b_5834_6240_3092_8a2d_5b9a_3059_308b" accesskey="u" rel="up">ASDFがコンパイルされたファイルを保持する場所を設定する</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Suo-Yin-_0028Yong-Yu-_0029.html#g_t_7d22_5f15_ff08_7528_8a9e_ff09" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
